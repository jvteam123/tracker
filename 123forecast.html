<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>123 PH Forecast</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#1e293b',    // Slate-800 equivalent
                        'dark-card': '#334155',  // Slate-700 equivalent
                        'primary-blue': '#3b82f6', // Blue-500
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Set the map container to take up most of the viewport height */
        #windy-container {
            width: 100%;
            height: 85vh; /* Increased height for immersion */
            min-height: 450px; 
            border-radius: 1rem; /* More rounded corners */
            overflow: hidden;
            /* Stronger shadow, blending with dark background */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7); 
            position: relative; 
            border: 2px solid #3b82f6; /* Subtle blue border for emphasis */
        }
        /* Style the iframe to fill the container */
        #windy-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<!-- Added a subtle gradient to the dark background for a better aesthetic -->
<body class="bg-dark-bg bg-gradient-to-br from-slate-900 via-dark-bg to-slate-900 flex flex-col items-center p-4 sm:p-10 font-sans min-h-screen text-white">

    <div class="max-w-6xl w-full">
        <!-- Header Section -->
        <header class="text-center mb-6 p-4">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-primary-blue mb-2 tracking-tight">
                123 PH Forecast
            </h1>
            <p class="text-slate-400 text-lg sm:text-xl font-light italic">
                Real-time, stunning visualization powered by Windy
            </p>
        </header>
        
        <!-- Toggle Switch for Satellite View -->
        <div class="flex justify-center mb-6">
            <div class="inline-flex items-center space-x-3 bg-dark-card p-2 rounded-full shadow-lg border border-slate-600">
                <span class="text-sm font-medium text-slate-300">Default View:</span>
                <button 
                    id="toggle-satellite" 
                    onclick="toggleView()" 
                    class="px-4 py-2 text-sm font-semibold rounded-full transition-all duration-300 bg-primary-blue text-white shadow-md hover:bg-blue-600 active:scale-95"
                    data-current-view="satellite"
                >
                    Satellite View
                </button>
            </div>
        </div>


        <!-- Windy Map Container (Now holding an iframe) -->
        <div id="windy-container" class="transition-all duration-300 hover:shadow-xl">
            <iframe 
                id="windy-iframe"
                src="" 
                title="Windy Weather Map"
                loading="lazy"
            ></iframe>
        </div>

        <!-- Footer / Credits (API key information removed as requested) -->
        <footer class="mt-8 text-center text-sm text-slate-500">
            <p>Weather forecast and visualization powered by Windy.</p>
            <p class="mt-1 text-xs opacity-75">For educational and development purposes only.</p>
        </footer>
    </div>

    <!-- 
        ========================================
        IFRAME WIDGET SCRIPT
        ========================================
    -->
    <script>
        // --- API Key (still used to unlock advanced features in the iFrame) ---
        const W_API_KEY = '9CbzreShuP283Fr5d8cuaqUBl37zeFcv';
        const MAP_BASE_URL = "https://embed.windy.com/embed2.html";
        const MAP_DEFAULT_OVERLAY = 'satellite'; // Changed default to satellite

        /**
         * Initializes the Windy iFrame with current settings.
         * @param {string} overlay - The weather overlay to display (e.g., 'satellite', 'wind', 'temp').
         */
        function initializeWindyIFrame(overlay = MAP_DEFAULT_OVERLAY) {
            
            // Define map parameters (customized for the Philippines)
            const params = new URLSearchParams({
                // Required parameters
                key: W_API_KEY,               // Your API Key
                lat: 12.88,                   // Center Latitude (Philippines)
                lon: 121.77,                  // Center Longitude (Philippines)
                zoom: 5,                      // Increased zoom to cover the whole country
                
                // Visualization and UI options
                current: 'true',              // Display current conditions
                overlay: overlay,             // Initial overlay - now dynamic
                product: 'gfs',               // Forecast model (only relevant for wind/temp overlays)
                menu: 'true', 
                header: 'dark', 
                
                // Other display options
                calendar: 'false',
                clouds: 'false',
                marker: 'false',
                detail: 'false',
                height: '100%',
                width: '100%',
                // Add play parameter for motion if using an animated layer
                // play: overlay === 'satellite' ? '1' : '0' // Enable motion for satellite view
            });

            const iframe = document.getElementById('windy-iframe');
            iframe.src = `${MAP_BASE_URL}?${params.toString()}`;
            console.log("iFrame source set:", iframe.src);
        }

        /**
         * Toggles between Satellite and Wind view.
         */
        function toggleView() {
            const button = document.getElementById('toggle-satellite');
            let currentView = button.getAttribute('data-current-view');
            let newView;
            let buttonText;
            
            if (currentView === 'satellite') {
                newView = 'wind';
                buttonText = 'Wind Layer';
            } else {
                newView = 'satellite';
                buttonText = 'Satellite View';
            }
            
            button.setAttribute('data-current-view', newView);
            button.textContent = buttonText;
            initializeWindyIFrame(newView);
        }


        // Initialize on page load
        window.onload = () => {
            initializeWindyIFrame(MAP_DEFAULT_OVERLAY);
        };
    </script>
</body>
</html>
